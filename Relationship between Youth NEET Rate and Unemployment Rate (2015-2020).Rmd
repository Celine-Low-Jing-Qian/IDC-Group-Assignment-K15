---
title: "Relationship between Youth NEET Rate and Unemployment Rate (2015-2020)"
author: "Justin Li"
date: "2025-12-07"
output: html_document
---

This R Markdown file analyzes the correlation between youth NEET (Not in Education, Employment, or Training) rate and youth unemployment rate across six continents from 2015 to 2020, and generates a combined panel plot with visible linear regression lines.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# Install and load required packages
if (!require(countrycode)) install.packages("countrycode")
if (!require(gridExtra)) install.packages("gridExtra")
library(readr)
library(dplyr)
library(ggplot2)
library(countrycode)
library(gridExtra)

# Load NEET dataset
df_neet <- read_csv("~/Desktop/youth-not-in-education-employment-training.csv", show_col_types = FALSE)
colnames(df_neet)[4] <- "NEET_rate"

# Custom continent mapping for specific countries
custom_continent <- c(
  "United States" = "North America", "Canada" = "North America", "Mexico" = "North America",
  "Jamaica" = "North America", "El Salvador" = "North America",
  "Brazil" = "South America", "Argentina" = "South America", "Chile" = "South America",
  "Australia" = "Oceania", "New Zealand" = "Oceania", "Fiji" = "Oceania",
  "Kazakhstan" = "Asia", "Japan" = "Asia", "South Korea" = "Asia", "Thailand" = "Asia",
  "Vietnam" = "Asia", "China" = "Asia", "Nigeria" = "Africa", "South Africa" = "Africa",
  "Ethiopia" = "Africa", "Germany" = "Europe", "France" = "Europe", "United Kingdom" = "Europe",
  "Italy" = "Europe", "Spain" = "Europe", "Switzerland" = "Europe", "Kosovo" = "Europe"
)

# Clean NEET data: calculate 2015-2020 average and assign continents
df_neet_clean <- df_neet %>%
  filter(Year >= 2015 & Year <= 2020, !is.na(NEET_rate)) %>%
  group_by(Entity) %>%
  summarise(NEET_rate = mean(NEET_rate, na.rm = TRUE), .groups = "drop") %>%
  mutate(
    Continent = suppressWarnings(countrycode(Entity, origin = "country.name", destination = "continent")),
    Continent = case_when(
      Entity %in% names(custom_continent) ~ custom_continent[Entity],
      TRUE ~ Continent
    )
  ) %>%
  filter(!is.na(Continent))

# Original unemployment data + supplementary 5 countries for Oceania/South America
unemp_data <- data.frame(
  Entity = c(
    # Original data
    "Kazakhstan", "Switzerland", "Japan", "South Korea", "Thailand", "Nigeria",
    "Germany", "Moldova", "Iceland", "Hong Kong", "Netherlands", "Vietnam",
    "Australia", "Malta", "Jamaica", "United States", "Czech Republic",
    "El Salvador", "Taiwan", "Austria", "Latvia", "Cyprus", "Poland",
    "United Kingdom", "Lithuania", "Denmark", "Bulgaria", "Ireland",
    "New Zealand", "Slovenia", "Canada", "Hungary", "Norway", "Saudi Arabia",
    "Euro Area", "Albania", "European Union", "Rwanda", "Turkey", "Slovakia",
    "China", "Georgia", "Luxembourg", "Croatia", "Belgium", "Portugal",
    "Greece", "France", "Estonia", "Kosovo", "Italy", "Iran", "Cape Verde",
    "Sri Lanka", "Finland", "Serbia", "Sweden", "Spain", "New Caledonia",
    "Romania", "Ethiopia", "Morocco", "Palestine", "Angola", "South Africa",
    # Supplement 5 countries for Oceania/South America
    "Fiji", "Brazil", "Argentina", "Chile", "Papua New Guinea"
  ),
  Unemp_Rate = c(
    # Original unemployment values
    3, 3.1, 3.5, 5.3, 5.9, 6.5, 6.6, 6.8, 6.9, 7.9, 9, 9.03, 9.6, 10.1, 10.2, 10.4,
    10.6, 11.8, 11.81, 12.1, 12.1, 12.6, 12.6, 12.7, 12.9, 13.2, 13.3, 13.4, 13.8,
    13.8, 14.1, 14.1, 14.4, 14.7, 14.8, 15.1, 15.2, 15.5, 15.6, 16.2, 17.3, 17.5,
    17.6, 17.8, 18, 18.3, 18.8, 18.9, 19.4, 19.5, 19.8, 20.2, 20.3, 20.8, 22.5, 23.4,
    24.6, 25.3, 26.2, 26.9, 27.2, 35.8, 37.6, 48.7, 58.5,
    # Supplemented values (2015-2020 average)
    11.7, 14.2, 13.5, 9.2, 12.5
  )
)

# Merge NEET and unemployment data
combined_data <- df_neet_clean %>%
  inner_join(unemp_data, by = "Entity") %>%
  filter(!is.na(NEET_rate) & !is.na(Unemp_Rate))

# Ensure coverage of six target continents
target_continents <- c("Asia", "Europe", "Africa", "North America", "South America", "Oceania")
combined_data <- combined_data %>%
  bind_rows(tibble(Continent = target_continents)) %>%
  distinct(Continent, Entity, .keep_all = TRUE)

# Define continent color palette
continent_colors <- c(
  "Asia" = "#2E86AB", "Europe" = "#A23B72", "Africa" = "#F18F01",
  "North America" = "#C73E1D", "South America" = "#3F88C5", "Oceania" = "#43AA8B"
)

# Initialize list to store plots
plot_list <- list()

# Create plot for each continent
for (cont in target_continents) {
  plot_data <- filter(combined_data, Continent == cont) %>%
    filter(!is.na(NEET_rate) & !is.na(Unemp_Rate)) %>%
    mutate(Entity = factor(Entity))
  
  # Create plot only if there are at least 2 data points
  if(nrow(plot_data) >= 2) {
    p <- ggplot(plot_data, aes(x = Unemp_Rate, y = NEET_rate, label = Entity)) +
      geom_point(
        color = continent_colors[cont], fill = adjustcolor(continent_colors[cont], alpha.f = 0.3),
        size = 4, shape = 21, stroke = 1
      ) +
      # Visible red best-fit line
      geom_smooth(
        method = "lm", se = FALSE, color = "red",
        linewidth = 1.5, fullrange = TRUE
      ) +
      geom_text(hjust = 1.1, vjust = 0.5, size = 3, color = "#333333", check_overlap = TRUE) +
      labs(
        title = cont,
        x = "Youth Unemployment Rate (%)",
        y = "Youth NEET Rate (%)"
      ) +
      # Minimize white space with adjusted axis limits
      scale_x_continuous(limits = c(min(plot_data$Unemp_Rate)*0.9, max(plot_data$Unemp_Rate)*1.1)) +
      scale_y_continuous(limits = c(min(plot_data$NEET_rate)*0.9, max(plot_data$NEET_rate)*1.1)) +
      theme_minimal() +
      theme(
        plot.title = element_text(size = 14, face = "bold", hjust = 0.5, color = continent_colors[cont]),
        axis.title = element_text(size = 11, face = "bold"),
        axis.text = element_text(size = 9),
        panel.grid = element_line(linetype = "dashed", color = "gray85"),
        panel.border = element_rect(color = "gray70", linewidth = 0.5, fill = NA),
        plot.margin = unit(c(0.2, 0.2, 0.2, 0.2), "cm")
      )
  } else {
    # Empty plot for continents with insufficient data
    p <- ggplot(data.frame()) +
      labs(title = cont, x = "Youth Unemployment Rate (%)", y = "Youth NEET Rate (%)") +
      theme_minimal() +
      theme(plot.title = element_text(size = 14, face = "bold", hjust = 0.5))
  }
  plot_list[[cont]] <- p
}

# Combine plots into a 2-row 3-column panel
final_plot <- grid.arrange(
  plot_list[["Asia"]], plot_list[["Europe"]], plot_list[["Africa"]],
  plot_list[["North America"]], plot_list[["South America"]], plot_list[["Oceania"]],
  nrow = 2, ncol = 3,
  top = "Relationship between Youth NEET Rate and Unemployment Rate (2015-2020)",
  bottom = "Data Source: Original CSV + Supplementary 2015-2020 Average Data"
)

# Save the final panel plot to desktop
ggsave(
  "~/Desktop/NEET_Unemployment_Visible_Bestfit_Line.png",
  plot = final_plot,
  width = 18, height = 12, dpi = 300, bg = "white"
)

# Print continent-wise country count
cat("=== Continent Data Count ===\n")
print(combined_data %>% filter(!is.na(NEET_rate)) %>% count(Continent, name = "Country_Count"))